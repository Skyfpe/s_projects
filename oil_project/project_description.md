# Выбор локации для скважины

**Описание**

Нефтедобывающей компании нужно решить, где бурить новую скважину. Нам предоставлены пробы нефти в трёх регионах: в каждом 10 000 месторождений, где измерили качество нефти и объём её запасов.

**Задача:** построить модель машинного обучения, которая поможет определить регион, где добыча принесёт наибольшую прибыль. Необходимо проанализировать возможную прибыль и риски.

**Условия задачи:**
- Для обучения модели подходит только линейная регрессия (остальные — недостаточно предсказуемые).
- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
- Бюджет на разработку скважин в регионе — 10 млрд рублей.
- При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.
- Распределения данных идентичны реальным, но в целях соблюдения коммерческой тайны сами данные и наименования признаков были подвергнуты маскингу.

Шаги для выбора локации:

- В избранном регионе ищут месторождения, для каждого определяют значения признаков;
- Строят модель и оценивают объём запасов;
- Выбирают месторождения с самым высокими оценками значений. Количество месторождений зависит от бюджета компании и стоимости разработки одной скважины;
- Прибыль равна суммарной прибыли отобранных месторождений.

<h1>Содержание<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Загрузка-и-подготовка-данных" data-toc-modified-id="Загрузка-и-подготовка-данных-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Загрузка и подготовка данных</a></span><ul class="toc-item"><li><span><a href="#Загрузка-данных" data-toc-modified-id="Загрузка-данных-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Загрузка данных</a></span></li><li><span><a href="#Подготовка-данных" data-toc-modified-id="Подготовка-данных-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Подготовка данных</a></span></li></ul></li><li><span><a href="#Обучение-и-проверка-модели" data-toc-modified-id="Обучение-и-проверка-модели-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Обучение и проверка модели</a></span><ul class="toc-item"><li><span><a href="#Обучение-и-результаты" data-toc-modified-id="Обучение-и-результаты-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Обучение и результаты</a></span><ul class="toc-item"><li><span><a href="#Обучение-первой-модели" data-toc-modified-id="Обучение-первой-модели-2.1.1"><span class="toc-item-num">2.1.1&nbsp;&nbsp;</span>Обучение первой модели</a></span></li><li><span><a href="#Отбор-признаков-для-первой-модели" data-toc-modified-id="Отбор-признаков-для-первой-модели-2.1.2"><span class="toc-item-num">2.1.2&nbsp;&nbsp;</span>Отбор признаков для первой модели</a></span></li><li><span><a href="#Вывод-по-отбору-признаков-для-первой-модели" data-toc-modified-id="Вывод-по-отбору-признаков-для-первой-модели-2.1.3"><span class="toc-item-num">2.1.3&nbsp;&nbsp;</span>Вывод по отбору признаков для первой модели</a></span></li><li><span><a href="#Обучение-второй-модели" data-toc-modified-id="Обучение-второй-модели-2.1.4"><span class="toc-item-num">2.1.4&nbsp;&nbsp;</span>Обучение второй модели</a></span></li><li><span><a href="#Обучение-третьей-модели" data-toc-modified-id="Обучение-третьей-модели-2.1.5"><span class="toc-item-num">2.1.5&nbsp;&nbsp;</span>Обучение третьей модели</a></span></li></ul></li><li><span><a href="#Проверка-моделей-на-адекватность" data-toc-modified-id="Проверка-моделей-на-адекватность-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Проверка моделей на адекватность</a></span></li><li><span><a href="#Выводы" data-toc-modified-id="Выводы-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>Выводы</a></span></li></ul></li><li><span><a href="#Подготовка-к-расчёту-прибыли" data-toc-modified-id="Подготовка-к-расчёту-прибыли-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Подготовка к расчёту прибыли</a></span><ul class="toc-item"><li><span><a href="#Вывод-по-подготовке-расчета-прибыли" data-toc-modified-id="Вывод-по-подготовке-расчета-прибыли-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>Вывод по подготовке расчета прибыли</a></span></li></ul></li><li><span><a href="#Расчет-рисков-и-прибыли-в-каждом-регионе" data-toc-modified-id="Расчет-рисков-и-прибыли-в-каждом-регионе-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Расчет рисков и прибыли в каждом регионе</a></span><ul class="toc-item"><li><span><a href="#Первый-регион" data-toc-modified-id="Первый-регион-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Первый регион</a></span></li><li><span><a href="#Второй-регион" data-toc-modified-id="Второй-регион-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Второй регион</a></span></li><li><span><a href="#Третий-регион" data-toc-modified-id="Третий-регион-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>Третий регион</a></span></li><li><span><a href="#Итоговый отчет" data-toc-modified-id="Итоговый отчет-4.4"><span class="toc-item-num">4.4&nbsp;&nbsp;</span>Итоговый отчет</a></span>
